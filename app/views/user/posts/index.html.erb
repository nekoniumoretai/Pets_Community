<h1>投稿一覧（全ユーザー）</h1>
<div class="row">
  <% @posts.each do |post| %>
    <div class="col-md-4 mb-4">
      <table class="table table-bordered">
        <tbody>
          <tr>
            <td><strong>ユーザーネーム</strong></td>
            <td><%= link_to post.user.nickname, user_path(post.user) %></td>
            <td>
              <% if current_user.following?(post.user) %>
                <%= link_to "フォローを外す", user_relationships_path(post.user), method: :delete %>
              <% else %>
                <%= link_to "フォローする", user_relationships_path(post.user), method: :post %>
              <% end %>
            </td>
          </tr>
          <!-- 画像が投稿されているかを確認。無ければ投稿画像欄ごと非表示にする -->
          <% if post.images.attached? %>
            <tr>
              <td colspan="2" class="text-center">
                <% post.images.each do |image| %>
                  <%= image_tag image, size: "50x50" %>
                <% end %>
              </td>
            </tr>
          <% end %>
          <tr>
            <td><strong>タイトル</strong></td>
            <td><%= link_to post.title, post_path(post) %></td>
          </tr>
          <tr>
            <!-- 投稿内容を50文字まで表示させる -->
            <td><strong>本文</strong></td>
            <td><%= strip_tags(post.content.to_s).truncate(50) %></td>
          </tr>
          <tr>
            <td>
              <p><%= link_to "#{post.post_comments.count}コメント", post_path(post.id) %></p>
              <p><%= render 'favorites', post: post %></p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  <% end %>
</div>
